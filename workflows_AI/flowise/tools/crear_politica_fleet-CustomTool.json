{
  "name": "crear_politica_fleet",
  "description": "Usa esta herramienta para registrar políticas en Fleet. Requiere EXACTAMENTE 5 parámetros: 'name', 'query', 'description', 'resolution' y 'platform'. No omitas ninguno bajo ninguna circunstancia.Usa esta herramienta para registrar políticas en Fleet. Requiere EXACTAMENTE 5 parámetros: 'name', 'query', 'description', 'resolution' y 'platform'. No omitas ninguno bajo ninguna circunstancia.",
  "color": "linear-gradient(rgb(96,75,233), rgb(54,57,173))",
  "iconSrc": "",
  "schema": "[{\"id\":0,\"property\":\"name\",\"description\":\"Nombre de la política\",\"type\":\"string\",\"required\":false},{\"id\":1,\"property\":\"query\",\"description\":\"Consulta SQL de Osquery\",\"type\":\"string\",\"required\":false},{\"id\":2,\"property\":\"description\",\"description\":\"Explicación del riesgo de seguridad\",\"type\":\"string\",\"required\":false},{\"id\":3,\"property\":\"resolution\",\"description\":\"Pasos para solucionar el problema.\",\"type\":\"string\",\"required\":false},{\"id\":4,\"property\":\"platform\",\"description\":\"OBLIGATORIO. El sistema operativo objetivo. Debes deducirlo de la petición del usuario. Escribe estrictamente uno de estos tres valores: \\\"windows\\\", \\\"linux\\\" o \\\"darwin\\\".\",\"type\":\"\",\"required\":false}]",
  "func": "/* Herramienta de Creación de Políticas */\nlet fetch;\ntry {\n    fetch = global.fetch || require('node-fetch');\n} catch (e) {\n    console.log(\"No se pudo cargar node-fetch, intentando continuar...\");\n}\n\nconst webhookUrl = \"http://172.30.168.212:5678/webhook/ejecutar-fleet\";\n\nconst options = {\n    method: 'POST',\n    headers: {\n        'Content-Type': 'application/json'\n    },\n    // ETIQUETA SECRETA: \"create_policy\" + Los 5 parámetros de la política\n    body: JSON.stringify({ \n        name: $name,\n        query: $query,\n        description: $description,\n        resolution: $resolution,\n        platform: \"windows\",\n        action: \"create_policy\" \n    }) \n};\n\ntry {\n    const response = await fetch(webhookUrl, options);\n    const text = await response.text();\n    \n    if (response.ok) {\n        const dataSegura = text.length > 2000 ? text.substring(0, 2000) + \"... [TRUNCADO]\" : text;\n        return `Política registrada con éxito en Fleet: ${dataSegura}`;\n    } else {\n        return `Error al crear política: ${response.status} - ${text}`;\n    }\n} catch (error) {\n    return `Error técnico de conexión: ${error.message}`;\n}",
  "workspaceId": "3c113b86-d70a-467f-9419-a72820084999"
}